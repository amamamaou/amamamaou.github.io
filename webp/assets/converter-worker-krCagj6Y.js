(function(){"use strict";self.addEventListener("message",async n=>{const{id:t,file:r,quality:i}=n.data;try{const e=await self.createImageBitmap(r),s=new OffscreenCanvas(e.width,e.height),o=s.getContext("2d");if(!o)throw new Error("Could not get OffscreenCanvasRenderingContext2D.");o.drawImage(e,0,0);const a=await s.convertToBlob({type:"image/webp",quality:i/100});if(a.type!=="image/webp")throw new Error("Conversion to WebP is not supported.");self.postMessage({id:t,blob:a,success:!0})}catch(e){e instanceof Error&&console.error(`Failed: ${t};`,e.message),self.postMessage({id:t,blob:new Blob,success:!1})}})})();
